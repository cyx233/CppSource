# Sort

### 数据结构

本题没有特殊的数据结构

### 构思

由于限制了比较的次数，为了避免输入敏感，判断应当改进归并排序，归并排序比较稳定

由于获得的是三路比较器，分析之后认为可以进行四路归并

### 原理

原理与普通归并排序完全相同，区别仅在于每次进行四路的归并。四个子序列合并为一个新的子序列，升序。

四路归并规则：

- 首先，随意选择其中3路，获得某一路至少比两个数大
-  由于至少比2个数大的一路不可能在两次比较中被选中，所以下一轮轮空，比较剩下3路，剩下3路的最小值即为4路的最小值，入列。
- 每次得到一个最小值的同时，能得知有一路至少比两个数大，所以每轮能入列一个当前最小值，同时确定下一轮哪三路进行比较。
- 当一路归并完后，退化为三路归并

三路归并规则：

- 直接通过三路比较器，每次入列最小值
- 当一路归并完后，退化为二路归并

二路归并规则：

- 选择一路，提供2个元素进行比较，另一路提供一个
- 比较结果有3种，（小大）+中，（小中）+大，（中大）+小。分析发现，（小大）+中的情况，能够直接入列小，中两个元素。（小中）+大的情况，也能直接入列（小中）两个元素
- 直到某个序列归并结束，将剩余的元素复制至序列末尾，完成一次归并操作

### 实现要点

正确的完成三种归并算法，层层退化

### 遇到的困难

第一次直接使用了朴素的二路归并，每次入列一个元素，导致limit error。所以构思了新的二路归并规则。此规则对$2\times n$个元素，最坏情况只需要$\frac{3}{2}n$次比较就能完成归并

改进后成功通过

### 复杂度估计

- 空间复杂度

  - 原序列使用$n$的空间
  - 归并需要的临时序列需要n的空间

  总空间复杂度为$O(n)$

- 时间复杂度

  - 分摊每次调用比较能够入列一个元素，所以所用时间为$nlog_4n$
  - 由于每个递归基需要额外多一次比较，总共多出$n$次优化，准确考虑应为$nlog_4n+n$
  - 考虑到二路归并有一些优化，所用时间应少于$nlog_4n+n$

  总时间复杂度为$O(nlogn)$

