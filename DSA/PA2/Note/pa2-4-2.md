## Kidd

### 数据结构

本题要求为区间修改，区间求和

所以应该使用线段树的数据结构

### 构思

每个节点存储左孩子下标，右孩子下标，懒惰标记和区间和

采用二分法划分区间

经典的线段树

### 原理

修改时，若当前区间被查询区间完全包含，直接修改区间和，先改变懒惰标记，不必立即向下递归

若区间被部分覆盖，二分当前区间，将懒惰标记下放，并更新左、右孩子的区间和。

若操作和左区间相交，递归左区间，右区间同理。

递归返回当前区间时，修改当前区间和为左、右相加

$nodes[current].sum=nodes[nodes[current].lc].sum + nodes[nodes[current].rc].sum;$



查询操作与修改操作几乎相同。只是查询操作是返回区间和，而不是修改区间和。

### 实现要点

区间总和应该使用$long\ long\ int$进行存储

在进行乘法操作时，懒惰标记也转化为$long\ long\ int$

### 遇到的困难

正确的实现线段树

差错主要在$long\ long\ int$相关的类型转换上

###　复杂度估计

- 时间复杂度：
  - 修改、查询每层最多递归两个节点，所以查询复杂度为$O(logn)$
  - 操作总次数为m
  - 所以总复杂度为$O(mlogn)$
- 空间复杂度
  - 修改、查询每层最多递归两个节点，一次操作产生新节点最多为$O(logn)$，操作总次数为m，所以总复杂度为$O(mlogn)$